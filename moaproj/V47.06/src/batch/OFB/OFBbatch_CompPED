/****o* RT BATCH/OFB:batch:OFBbatch_CompPED
* NOMBRE
*   OFB:batch:OFBbatch_CompPED
* DESCRIPCION
*   Rutina que ejecuta procesos de mensajeria al switch desde el Rt_batch
*   para el registro de los Comprobantes de  Nota de Credito y Factura PED
* ENTRADAS
*   Parámetros de entrada de la rutina, sean argumentos o campos que tiene en cuenta
* SALIDAS
*   Campos modificados como resultado o returns cuyos valores sean no triviales
* IMPACTOS
*   Otros objetos que deberán ser analizados al modificar el objeto actual
* REFERENCIADO POR
*   OFB:batch:OFBrecupCaidasVuelo
* DOCUMENTACION
*   
* SOURCE
*/
#include "batchofb.h"

SUB batch:OFBbatch_CompPED(fecha,hora)
	FPRINT common:csr_string,"\n\n<<Inicio Proceso Registro Comprobante de NC y FACT de Piezas PED. Fecha: %e Hora: %e >",fecha,hora
	CALL batch:MISCgeneraLog(common:csr_string,"INFO","N")
	CALL batch:MISCgeneraLog("\n--------------------------------------","INFO","N")
	CALL post:OFBprocBatch_CompPED //OFBproc_batch_PED
	SELECT (lib:err_retval)
		CASE -1
			//Problemas de actualizacion en las tablas... Salgo del proceso rt
			BREAK
		CASE -2
			//gpb:PS10724
			FPRINT common:csr_string_171,"\nNo hay comunicación con el Host. Se intenta reestablecer Conexion. Fecha: %e Hora: %e ",fecha,hora
			CALL batch:OFBlog_batch(common:csr_string_171,0,"N","S","AMBOS","N")
			BREAK
		CASE TRAN_CAIDA_VUELO
			//gpb:PS10724
			FPRINT common:csr_string_171,"\nSe produjo una caída en vuelo. Fecha: %e Hora: %e ",fecha,hora
			CALL batch:OFBlog_batch(common:csr_string_171,0,"N","S","AMBOS","N")
			BREAK
	END SELECT
	//gpb:PS10724
	FPRINT common:csr_string,"\n\n<<Fin Proceso Registro Comprobante de NC y FACT de Piezas PED. Fecha: %e Hora: %e >>\n",fecha,hora
	CALL batch:MISCgeneraLog(common:csr_string,"INFO","N")
	CALL MISCgeneraLog("\n*****************************************************************\n","INFO","N")        
END SUB

/*******/
