/****o* Pago en Destino/OFB:post:MISCdureCaracterPED
* NOMBRE
*   OFB:post:MISCdureCaracterPED
* DESCRIPCION
*   Validacion de caracteres invalidos
* ENTRADAS
*		P_cadena
* SALIDAS
*   Parámetros de entrada de la rutina, sean argumentos o campos que tiene en cuenta
* SALIDAS
*   Campos modificados como resultado o returns cuyos valores sean no triviales
* IMPACTOS
*   Otros objetos que deberán ser analizados al modificar el objeto actual
* REFERENCIADO POR
*		post:MISCvalReg3_4PED
* DOCUMENTACION
*   NI50479
* SOURCE
*/
#include "postmisc.h"

SUB post:MISCdureCaracterPED(P_cadena)
	LOCAL l_cadena LIKE common:csr_string
	LOCAL Indice LIKE lib:err_retval
	LOCAL Caracter LIKE common:csr_string
	LOCAL InvalidChars LIKE common:csr_string
	LOCAL longitud LIKE siaf:i
	LOCAL counter LIKE siaf:i 
	
	LET InvalidChars = "0123456789"

	LET l_cadena = P_cadena
	longitud = l_cadena.NUMCHARS
	
	IF (longitud > 0) THEN 
		counter = 0
		WHILE (counter < longitud)
			Caracter = SUBSTR(l_cadena,counter,1)

	    SELECT (Caracter)
	      CASE ">"
	      CASE "<"
	      CASE ':'
	      CASE ';'
	      CASE '-'
	      CASE '('
	      CASE ')'
	      CASE '['
	      CASE ']'
	      CASE '?'
	      CASE '\xBF'
	      //¿
	      CASE '\xAA'
	      //ª
	      CASE '¬'
	      CASE '*'
	      CASE '#'
	      CASE '/'
	      CASE '+'
	      CASE '='
	      CASE '$'
	      CASE '&'
	      CASE '%'
	      CASE '\x22'
	      //"
	      CASE '¡'
	      CASE '!'
	      CASE '.'
	      CASE '°'
	      CASE '\x27'
	      //'
	      CASE '\x2C'
	      //,
	      CASE '\x5E'
	      //^
	      CASE '\x7E'
	      //~
	      CASE '\xA8'
	      //¨
	      CASE ','
	      CASE '|'
	      CASE '@'
	      CASE '}'
	      CASE '{'
	      CASE '_'
	      CASE '¦'
	      CASE '\xB4'
	      //´
				CASE '\xE1'
				//á
				CASE '\xE9'
				//é
				CASE '\xED'
				//í
				CASE '\xF3'
				//ó
				CASE '\xFA'
				//ú
				CASE '\xC1'
				//Á
				CASE '\xC9'
				//É
				CASE '\xCD'
				//Í
				CASE '\xD3'
				//Ó
				CASE '\xDA'
				//Ú    
					RETURN -2
				CASE ELSE
					CALL  csr:str_search (InvalidChars, Caracter , Indice)
					IF (Indice >= 0) THEN
						RETURN -2
					END IF
					BREAK
	    END SELECT 	
	    
			counter = counter + 1
		END WHILE
	END IF
	RETURN 0	

END SUB

/*******/
